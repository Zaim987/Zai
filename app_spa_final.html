
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>QuantumX SPA</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />

  <style>
    .page {
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    .page.active {
      display: block !important;
      opacity: 1;
    }
  </style>
</head>

<body>
  <div id="app">
    <div id="page-index" class="page" style="display:none;">
<div class="splash" id="splash">
    <div class="logo fade-in delay-1" id="logo">QuantumX</div>
    <div class="headline fade-in delay-2" id="headline">Masuki Dunia Digitalmu</div>
    <div class="subtext fade-in delay-3" id="subtext">Ini bukan masa depan ‚Äî ini sekarang.</div>
    <button class="fade-in delay-4" id="startBtn" onclick="startExit()">Mulai Sekarang</button>
  </div>
  <script>
    function startExit() {
      const logo = document.getElementById('logo');
      const headline = document.getElementById('headline');
      const subtext = document.getElementById('subtext');
      const button = document.getElementById('startBtn');
      setTimeout(() => logo.classList.add('fade-out'), 0);
      setTimeout(() => headline.classList.add('fade-out'), 200);
      setTimeout(() => subtext.classList.add('fade-out'), 400);
      setTimeout(() => button.classList.add('fade-out'), 600);
      setTimeout(() => { window.location.href = 'login.html'; }, 1200);
    }
  </script>
</div>

<div id="page-login" class="page" style="display:none;">
<div class="login-container">
    <div id="logo" class="logo-text fade-in fade-delay-1">QuantumX</div>
    <div id="headline" class="headline fade-in fade-delay-2">Selamat datang kembali</div>
    <form id="loginForm" class="fade-in fade-delay-3">
      <input id="email" type="email" placeholder="Email" required />
      <input id="password" type="password" placeholder="Password" required />
      <button type="submit">Login</button>
      <div id="error" class="error"></div>
    </form>
    <div id="registerLink" class="fade-in fade-delay-4">
      <a id="toRegister" href="register.html">Belum Punya Akun, Register</a>
    </div>
  </div>  <!-- ‚úÖ Auto login notice -->  <div id="autoLoginNotice">
    <div>‚úÖ Sudah masuk</div>
    <div id="countdown">8</div>
  </div>  <!-- ‚úÖ Fix: Tambahkan firebase-init lebih dulu -->  <script type="module" src="js/firebase-init.js"></script>  <script type="module" src="js/wislogin.js"></script>  <script type="module" src="js/login.js"></script>
</div>

<div id="page-register" class="page" style="display:none;">
<div id="overlay"></div>
  <div class="register-container">
    <div class="logo-text fade-in fade-delay-1">QuantumX</div>
    <div class="headline fade-in fade-delay-2">Buat akun baru</div>
    <form id="registerForm" class="fade-in fade-delay-3">
      <input id="name" type="text" placeholder="Nama lengkap" required />
      <input id="email" type="email" placeholder="Email" required />
      <input id="password" type="password" placeholder="Password" required />
      <button type="submit">Daftar</button>
      <div id="error" class="error"></div>
    </form>
    <div class="fade-in fade-delay-5"><a href="login.html">Sudah punya akun? Login</a></div>
  </div>

  
<script type="module" src="js/register.js"></script>
</div>

<div id="page-dashboard" class="page" style="display:none;">
<div id="splash-screen">
<h1 class="splash-logo">QuantumX</h1>
</div>
<div class="hidden" id="main-content">
<header class="top-bar">
<div class="logo">QuantumX</div>
<div class="scroll-wrapper">
<nav class="menu-bar">
<button class="menu-btn">Dashboard</button>
<button class="menu-btn">Chat</button>
<button class="menu-btn">Pengguna</button>
<button class="menu-btn">Pengaturan</button>
<button class="menu-btn logout">Logout</button>
</nav>
</div>
</header>
<main class="dashboard">
<h1 class="welcome-text">Selamat Datang, Zaim!</h1>
<p class="desc-text">Iki Perubahan Dunia Modern Ini Sekarang Bukan Nanti</p>

<div class="extra-content-wrapper">
<div class="extra-content">
<h2 class="stagger-item" style="animation-delay: 0.00s;">Artikel Menarik</h2>
<h3 class="stagger-item" style="animation-delay: 0.15s;">ROG: Raja Gaming Hardware</h3>
<p class="stagger-item" style="animation-delay: 0.30s;">Republic of Gamers (ROG) wis dadi legenda ning dunia gaming hardware. Wiwit GPU, motherboard, nganti laptop, kabeh produk√© ROG nduweni performa edan lan desain sing futuristik. Nek kowe gamer sejati, ROG mesthi ana nang wishlist-mu!</p>
<h3 class="stagger-item" style="animation-delay: 0.45s;">5 Tips Merawat Laptop Gaming</h3>
<p class="stagger-item" style="animation-delay: 0.60s;">Laptop gaming butuh perhatian ekstra. Jaga suhu tetep adem nganggo cooling pad, bersihin kipas secara berkala, gunakake charger asli, lan aja nganti main sambil nutupi ventilasi. Rawat apik, performane tetep ndrodok!</p>
<h3 class="stagger-item" style="animation-delay: 0.75s;">Sejarah ROG lan Inovasi Edan</h3>
<p class="stagger-item" style="animation-delay: 0.90s;">ROG lahir tahun 2006 minangka sub-brand ASUS kanggo para gamer hardcore. Saka motherboard munggah dadi laptop, nganti peripheral kabeh disemproti teknologi canggih. Contohe? Sistem pendingin liquid chamber, RGB addressable, keyboard opto-mechanical, sampe layar mini-LED 240Hz.</p>
<p class="stagger-item" style="animation-delay: 1.05s;">Inovasi ora mandeg. ROG nyedekake AI cooling, teknologi mux switch dinamis, lan desain portable tanpa ngorbanke performa. ROG ngerteni apa sing gamer butuh: performa, gaya, lan kontrol total. Iki alasan kenapa ROG terus ana ning papan paling dhuwur industri gaming hardware.</p>
<h3 class="stagger-item" style="animation-delay: 1.20s;">Apa Bedane ROG karo Sing Liyane?</h3>
<p class="stagger-item" style="animation-delay: 1.35s;">ROG ora mung kuat, tapi uga tampil beda. Build quality premium, fitur eksklusif kaya Armoury Crate lan Keystone, aesthetic desain cyberpunk, kabeh digabung karo spek ganas. Siji tembung: karismatik. Nek nguripke ROG, rasane kaya nguripke tank modern sing bisa joget. üòé</p>
<h3 class="stagger-item" style="animation-delay: 1.50s;">Worth it ora ROG kuwi?</h3>
<p class="stagger-item" style="animation-delay: 1.65s;">Yen budgetmu cukup lan kowe pengin perangkat sing ora mung sekadar ngangkat game, tapi uga ngangkat gengsimu... ROG iku jawabane. Saka casual gamer nganti pro e-sport, ROG menehi pengalaman maksimal ‚Äî ora mung fps tinggi, tapi rasa bangga ning saben ketik tombol lan klik mouse.</p>
<h3 class="stagger-item" style="animation-delay: 1.80s;">Ngapa Aku Pilih ROG, Dudu Laptop Biasa?</h3>
<p class="stagger-item" style="animation-delay: 1.95s;">Nek kowe ngerti bedane mie rebus karo mie instan + toping telur + kornet + cabe 5, yo kuwi bedane laptop biasa karo ROG. Laptop biasa? Yo mung iso buka browser, nulis tugas. Tapi ROG? Nguripke game sak jagad, render Blender, ngedit video sambil ngrokok ngidul. Nganti BIOS wae glowing, ngecas rasane kayak ngisi chakra.</p>
<h3 class="stagger-item" style="animation-delay: 2.10s;">Game Sing Cocok Nek Wis Duwe ROG</h3>
<ul class="stagger-item" style="animation-delay: 2.25s;">
<li class="stagger-item" style="animation-delay: 2.40s;"><strong>Cyberpunk 2077</strong> ‚Äì iso ultra tanpa ritual tolak bala</li>
<li class="stagger-item" style="animation-delay: 2.55s;"><strong>Valorant</strong> ‚Äì crosshair gerak luwih cepet ketimbang pikiran</li>
<li class="stagger-item" style="animation-delay: 2.70s;"><strong>Elden Ring</strong> ‚Äì mlayu-mlayu ning alam semesta, fps stabil</li>
<li class="stagger-item" style="animation-delay: 2.85s;"><strong>Minecraft RTX</strong> ‚Äì omah desa rasa villa Bali</li>
</ul>
<h3 class="stagger-item" style="animation-delay: 3.00s;">Tips Supaya ROGmu Ora Mlethek Awal</h3>
<p class="stagger-item" style="animation-delay: 3.15s;">- Aja digowo turu, ojo ngeteh bareng adaptor<br/>
          - Charger asli, nek ilang... mending ilang mantan<br/>
          - Kipas dudu sarang laba-laba, kudu disayang<br/>
          - RGB apik, tapi ojo nganti ngalahne cahayane masa depanmu</p>
<h3 class="stagger-item" style="animation-delay: 3.30s;">Rasa Bangga Sing Muncul Nek Nggowo ROG</h3>
<p class="stagger-item" style="animation-delay: 3.45s;">Kanca: ‚ÄúWah iki laptop-mu murup dewe?‚Äù<br/>
          Tukang servis: ‚ÄúIki gak usah tak oprek, tak pujani wae.‚Äù<br/>
          Loading screen? Wis ilang sadurunge sampeyan ndelok</p>
<h3 class="stagger-item" style="animation-delay: 3.60s;">Penutup</h3>
<p class="stagger-item" style="animation-delay: 3.75s;">ROG dudu mung laptop, iki mimpi anak cilik sing wis kesel dicibir PC rakitan. Kowe pengin menang ngelawan musuh, opo kalah karo lag? Nek isih nge-lag nganggo ROG, berarti setan ono nang RAM-mu, asu! üê∂</p>
</div>
</div>
</main>
</div>
<script src="js/auth-guard.js" type="module"> </script>

<script src="js/logout.js" type="module"> </script>
<script>
// # Staggered Ninja Reveal Artikel ROG
document.addEventListener("DOMContentLoaded", () => {
  const items = document.querySelectorAll(".stagger-item");
  items.forEach((el) => {
    el.style.opacity = "0"; // jaga-jaga overwrite manual inline style
  });
});
</script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const pengaturanBtn = [...document.querySelectorAll(".menu-btn")]
      .find(btn => btn.textContent.trim() === "Pengaturan");

    pengaturanBtn?.addEventListener("click", () => {
      document.body.classList.add("fade-out-up");
      setTimeout(() => {
        window.location.href = "set.html";
      }, 700);
    });
  });
</script>

<script>
  // Skrip untuk tombol Pengguna
  document.addEventListener("DOMContentLoaded", () => {
    const penggunaBtn = [...document.querySelectorAll(".menu-btn")]
      .find(btn => btn.textContent.trim() === "Pengguna");

    penggunaBtn?.addEventListener("click", () => {
      document.body.classList.add("fade-out-up");
      setTimeout(() => {
        window.location.href = "user.html";
      }, 700);
    });
  });
</script>
</div>

<div id="page-user" class="page" style="display:none;">
<div class="top-bar">
    <div class="logo">QuantumX</div>
    <div class="menu-bar">
      <button class="menu-btn">Dashboard</button>
      <button class="menu-btn">Chat</button>
      <button class="menu-btn">Pengguna</button>
      <button class="menu-btn">Pengaturan</button>
      <button class="menu-btn logout">Logout</button>
    </div>
  </div>

  <main class="dashboard">
    <h1 class="welcome-text">Manajemen Pengguna</h1>
    <p class="desc-text">Kelola semua pengguna yang terdaftar di sistem QuantumX.</p>

    <div style="text-align:center; margin-bottom: 1rem;">
      <button class="role-filter" data-role="all">Semua</button>
      <button class="role-filter" data-role="admin">Admin</button>
      <button class="role-filter" data-role="member">Member</button>
      <button id="export-csv"> Export CSV</button>
    </div>

    <div id="loading-spinner"><div class="spinner-circle"></div></div>
    <div class="user-list-container" id="user-list-container"></div>
  </main>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
    import { getFirestore, collection, getDocs, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyApM08t1ghCxK56_0znbPMT9i5zduOKmn0",
      authDomain: "quantechapp.firebaseapp.com",
      projectId: "quantechapp",
      storageBucket: "quantechapp.appspot.com",
      messagingSenderId: "825384610343",
      appId: "1:825384610343:web:e490bc84877e6d7a93bc02"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);

    async function fetchAndDisplayUsers(filterRole = "all") {
      const container = document.getElementById('user-list-container');
      const loader = document.getElementById('loading-spinner');
      container.innerHTML = '';
      loader.style.display = 'flex';
      let delay = 2.5;

      try {
        const querySnapshot = await getDocs(collection(db, "users"));
        querySnapshot.forEach((doc) => {
          const user = doc.data();
          const role = user.role || 'member';
          if (filterRole !== "all" && role.toLowerCase() !== filterRole.toLowerCase()) return;
          const roleClass = role.toLowerCase() === 'admin' ? 'admin' : 'member';
          const userCard = document.createElement('div');
          userCard.className = 'user-card stagger-item';
          userCard.style.animationDelay = `${delay}s`;

          const avatarHTML = user.photoURL
            ? `<img src="${user.photoURL}" alt="Avatar" class="avatar-img" />`
            : `<div class="avatar"></div>`;

          userCard.innerHTML = `
            ${avatarHTML}
            <div class="user-info">
              <h3>${user.displayName || 'Tanpa Nama'}</h3>
              <p>${user.email || 'Tanpa Email'}</p>
            </div>
            <span class="role ${roleClass}">${role}</span>
          `;
          container.appendChild(userCard);
          delay += 0.2;
        });
      } catch (error) {
        console.error("Error fetching users: ", error);
        container.innerHTML = `<p style="color: red; text-align: center;">Gagal memuat data pengguna. Cek console (F12).</p>`;
      } finally {
        loader.style.display = 'none';
      }
    }

    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        window.location.href = "login.html";
        return;
      }
      try {
        const userRef = doc(db, "users", user.uid);
        const userSnap = await getDoc(userRef);
        if (!userSnap.exists()) {
          alert("Data pengguna tidak ditemukan.");
          window.location.href = "dashboard.html";
          return;
        }
        const userData = userSnap.data();
        const role = (userData.role || "member").toLowerCase();
        if (role !== "admin") {
          showAdminAlert(); setTimeout(() => { window.location.href = "dashboard.html"; }, 2000);
          window.location.href = "dashboard.html";
          return;
        }
        fetchAndDisplayUsers();
      } catch (error) {
        console.error("Gagal mengambil data user:", error);
        alert("Terjadi kesalahan. Coba lagi.");
        window.location.href = "dashboard.html";
      }
    });

    document.addEventListener("DOMContentLoaded", () => {
      document.querySelectorAll('.role-filter').forEach(button => {
        button.addEventListener('click', () => {
          const role = button.getAttribute('data-role');
          fetchAndDisplayUsers(role);
        });
      });
    });

    document.getElementById("export-csv").addEventListener("click", async () => {
      const csvRows = [["Display Name", "Email", "Role"]];
      try {
        const querySnapshot = await getDocs(collection(db, "users"));
        querySnapshot.forEach((doc) => {
          const user = doc.data();
          const row = [
            `"${user.displayName || 'Tanpa Nama'}"`,
            `"${user.email || 'Tanpa Email'}"`,
            `"${user.role || 'member'}"`
          ];
          csvRows.push(row);
        });
        const csvContent = csvRows.map(e => e.join(",")).join("\n");
        const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
        const url = URL.createObjectURL(blob);
        const link = document.createElement("a");
        link.href = url;
        link.setAttribute("download", "users.csv");
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      } catch (err) {
        console.error("Gagal export CSV:", err);
        alert("Gagal export data. Cek console.");
      }
    });
  
function showAdminAlert() {
  document.getElementById('adminAlert').classList.remove('hidden');
}

function closeModal() {
  document.getElementById('adminAlert').classList.add('hidden');
}

</script>

<!-- MODAL ADMIN GLOWING ENABLED -->
<div id="adminAlert" class="custom-modal hidden">
  <div class="modal-content">
    <h3>‚ö†Ô∏è Akses Ditolak</h3>
    <p>Hanya admin yang boleh masuk.</p>
    <button onclick="closeModal()">Oke</button>
  </div>
</div>
</div>

<div id="page-statistik" class="page" style="display:none;">
<div class="chat-wrapper">
<header class="top-bar">
<div class="logo">QuantumX <span id="dm-target-label"></span></div>
<div>
<button class="menu-btn" onclick="resetDM()">üåê Umum</button>
<button class="menu-btn" onclick="goBack()">‚¨Ö Dashboard</button>
</div>
</header>
<main class="chat-box">
<h2 class="welcome-text">Selamat Datang!</h2>
<div class="message-list" id="messages"></div>
<div class="chat-input">
<input id="msgInput" placeholder="Ketik pesenmu..." type="text"/>
<button onclick="sendMessage()">Kirim</button>
</div>
</main>
<div id="user-list">
<h3>Daftar Pengguna</h3>
<div id="users"></div>
</div>
</div>
</div>

<div id="page-set" class="page" style="display:none;">
<div id="splash-screen"><div class="splash-logo">QuantumX</div></div>

  <div class="main-content" id="main-content">
    <h1 class="stagger">‚öôÔ∏è Pengaturan Akun</h1>
    <div class="settings-container stagger">
      <form id="settings-form">
        <label for="username" class="stagger">Nama Pengguna</label>
        <input type="text" id="username" placeholder="Zaim Moder Handal" class="stagger"/>

        <label for="theme" class="stagger">Tema Tampilan</label>
        <select id="theme" class="stagger">
          <option value="default">Default (Neon)</option>
          <option value="dark">Dark Mode</option>
          <option value="cyberpunk">Cyberpunk</option>
        </select>

        <button type="submit" class="stagger">üíæ Simpen Pengaturan</button>
        <div class="back-link stagger" onclick="goBack()">‚¨ÖÔ∏è Kembali ke Dashboard</div>
      </form>
    </div>
  </div>

  <script>
    function goBack() {
      window.location.href = "dashboard.html";
    }

    window.addEventListener("DOMContentLoaded", () => {
      setTimeout(() => {
        document.getElementById("main-content").style.display = "block";
      }, 3100);
    });
  </script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyApM08t1ghCxK56_0znbPMT9i5zduOKmn0",
      authDomain: "quantechapp.firebaseapp.com",
      projectId: "quantechapp",
      storageBucket: "quantechapp.appspot.com",
      messagingSenderId: "825384610343",
      appId: "1:825384610343:web:e490bc84877e6d7a93bc02"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);

    const usernameInput = document.getElementById("username");
    const themeSelect = document.getElementById("theme");
    const form = document.getElementById("settings-form");

    onAuthStateChanged(auth, async (user) => {
      const docRef = doc(db, "users", user.uid);
const docSnap = await getDoc(docRef);
if (user) {
    console.log("üë§ UID LOGIN:", user.uid);
    if (docSnap.exists()) {
      const data = docSnap.data();
      const theme = data.theme || "default";
      document.body.dataset.theme = theme;
      document.getElementById("theme").value = theme;
    }

    // Preview tema langsung saat dropdown diganti
    const themeSelect = document.getElementById("theme");
    themeSelect.addEventListener("change", function () {
      document.body.dataset.theme = this.value;
    });

    form.addEventListener("submit", async (e) => {
          e.preventDefault();
          const displayName = usernameInput.value || "Zaim";
          const theme = themeSelect.value;
  console.log("‚è∫Ô∏è DISIMPEN:", displayName, theme);

          try {
            await setDoc(doc(db, "users", user.uid), {
              displayName,
              theme
            }, { merge: true });
            alert("‚úÖ Pengaturan Disimpen ke Firestore!");
          } catch (err) {
            console.error("‚ùå Gagal nyimpen:", err);
            alert("‚ùå Gagal nyimpen pengaturan!");
          }
        });
      } else {
        alert("‚ö†Ô∏è Belum login! Arahke login page.");
        window.location.href = "login.html";
      }
    });
  </script>
</div>
  </div>

  <script src="js/firebase-init.js" type="module"></script>
  <script src="js/auth-guard.js" type="module"></script>
  <script src="js/login.js" type="module"></script>
  <script src="js/logout.js" type="module"></script>
  <script src="js/register.js" type="module"></script>
  <script src="js/load-users.js" type="module"></script>

  
  <script>
    const pages = document.querySelectorAll('.page');
    function showPage(name) {
      pages.forEach(p => {
        p.classList.remove('active');
        setTimeout(() => p.style.display = 'none', 200);
      });

      const page = document.getElementById('page-' + name);
      if (page) {
        page.style.display = 'block';
        setTimeout(() => page.classList.add('active'), 10);
      }
    }

    function handleHashChange() {
      const hash = location.hash.replace('#', '') || 'index';
      showPage(hash);
    }

    window.addEventListener('hashchange', handleHashChange);
    window.addEventListener('DOMContentLoaded', () => {
      // Biar tombol navigasi bisa ubah hash
      document.querySelectorAll('.nav-link').forEach(btn => {
        btn.addEventListener('click', e => {
          const target = btn.getAttribute('data-target');
          if (target) window.location.hash = target;
        });
      });
      handleHashChange();
    });
  </script>
</body>
</html>
