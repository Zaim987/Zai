<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Pengguna - QuantumX</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet" />
    <style>
        /* SEMUA CSS DARI DASHBOARD DICOPY KE SINI UNTUK KONSISTENSI */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body {
            width: 100%; height: 100%; background-color: #020202; color: white;
            font-family: 'Orbitron', sans-serif; overflow: hidden;
        }
        .top-bar {
            display: flex; align-items: center; justify-content: space-between;
            padding: 1rem; background-color: black; gap: 1rem;
            overflow: hidden; opacity: 0;
            animation: fadeInText 1s ease-out 0.5s forwards; /* Animasi masuk lebih cepat */
        }
        .logo {
            font-size: 1.5rem; font-weight: bold;
            text-shadow: 0 0 10px cyan; white-space: nowrap;
            pointer-events: none;
        }
        .scroll-wrapper { overflow-x: auto; flex-grow: 1; }
        .scroll-wrapper::-webkit-scrollbar { display: none; }
        .menu-bar { display: flex; gap: 1rem; width: max-content; }
        .menu-btn {
            background: none; color: white; border: none; font-size: 1rem;
            cursor: pointer; opacity: 0; transform: translateY(-10px);
            animation: fadeInUp 0.6s ease-out forwards;
        }
        .menu-btn:nth-child(1) { animation-delay: 0.8s; }
        .menu-btn:nth-child(2) { animation-delay: 1.0s; }
        .menu-btn:nth-child(3) { animation-delay: 1.2s; }
        .menu-btn:nth-child(4) { animation-delay: 1.4s; }
        .menu-btn:nth-child(5) { animation-delay: 1.6s; }
        
        .dashboard {
            padding: 2rem; text-align: center;
            opacity: 0; animation: demoFade 0.5s ease-in-out 1s forwards;
        }
        .welcome-text {
            font-size: 2rem; margin-bottom: 1rem;
            opacity: 0; transform: translateY(20px) scale(0.95);
            animation: welcomeAnim 1.2s ease-out 1.5s forwards;
            text-shadow: 0 0 10px cyan;
        }
        .desc-text {
            font-size: 1rem; color: #ccc;
            opacity: 0; transform: translateY(20px);
            animation: descAnim 1s ease-out 2.0s forwards;
            margin-bottom: 3rem;
        }
        
        /* Gaya khusus untuk daftar pengguna */
        .user-list-container {
            max-width: 800px;
            margin-inline: auto;
            text-align: left;
            height: calc(100vh - 250px); /* Tinggi dinamis agar bisa scroll */
            overflow-y: auto;
            padding-right: 1rem;
        }
        .user-list-container::-webkit-scrollbar { display: none; } /* Sembunyikan scrollbar */
        
        .user-card {
            display: flex;
            align-items: center;
            background-color: rgba(20, 20, 20, 0.5);
            border-left: 3px solid cyan;
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 4px;
            gap: 1rem;
        }
        .user-card .avatar {
            font-size: 2rem;
            color: cyan;
        }
        .user-card .user-info {
            flex-grow: 1;
        }
        .user-card h3 {
            margin: 0;
            color: #fff;
        }
        .user-card p {
            margin: 0;
            color: #aaa;
            font-size: 0.9rem;
        }
        .user-card .role {
            padding: 0.3rem 0.6rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        .role.admin {
            background-color: #ff4757;
            color: white;
            text-shadow: 0 0 5px black;
        }
        .role.member {
            background-color: #2ed573;
            color: white;
            text-shadow: 0 0 5px black;
        }

        /* Animasi yang dibutuhkan */
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
        @keyframes demoFade { to { opacity: 1; } }
        @keyframes welcomeAnim { to { opacity: 1; transform: translateY(0) scale(1); } }
        @keyframes descAnim { to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInText { to { opacity: 1; } }
        @keyframes fadeOutUp {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-20px); visibility: hidden; }
        }
        .fade-out-up { animation: fadeOutUp 0.6s ease-in-out forwards; }

        .stagger-item {
            opacity: 0;
            transform: translateY(20px);
            animation: staggerFadeUp 0.6s ease-out forwards;
        }
        @keyframes staggerFadeUp {
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="main-content">
        <header class="top-bar">
            <div class="logo">QuantumX</div>
            <div class="scroll-wrapper">
                <nav class="menu-bar">
                    <button class="menu-btn">Dashboard</button>
                    <button class="menu-btn">Chat</button>
                    <button class="menu-btn">Pengguna</button>
                    <button class="menu-btn">Pengaturan</button>
                    <button class="menu-btn logout">Logout</button>
                </nav>
            </div>
        </header>
        <main class="dashboard">
            <h1 class="welcome-text">Manajemen Pengguna</h1>
            <p class="desc-text">Kelola semua pengguna yang terdaftar di sistem QuantumX.</p>

            <div class="user-list-container" id="user-list-container">
                </div>
        </main>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Fungsi umum untuk menangani klik menu
        const handleNavClick = (buttonText, targetUrl) => {
          const button = [...document.querySelectorAll(".menu-btn")]
            .find(btn => btn.textContent.trim() === buttonText);

          button?.addEventListener("click", () => {
            if (window.location.href.endsWith(targetUrl)) return;
            document.body.classList.add("fade-out-up");
            setTimeout(() => { window.location.href = targetUrl; }, 700);
          });
        };

        handleNavClick("Dashboard", "dashboard.html");
        handleNavClick("Chat", "statistik.html");
        handleNavClick("Pengaturan", "set.html");
        handleNavClick("Pengguna", "user.html");
      });
    </script>
    
    <script src="js/logout.js" type="module"></script>

    <script type="module">
        // Import fungsi yang diperlukan dari Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js";

        // GANTI DENGAN KONFIGURASI FIREBASE ANDA
        
const firebaseConfig = {
  apiKey: "AIzaSyApM08t1ghCxK56_0znbPMT9i5zduOKmn0",
  authDomain: "quantechapp.firebaseapp.com",
  projectId: "quantechapp",
  storageBucket: "quantechapp.appspot.com",
  messagingSenderId: "825384610343",
  appId: "1:825384610343:web:e490bc84877e6d7a93bc02"
};

        // Inisialisasi Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Fungsi untuk mengambil dan menampilkan data pengguna
        async function fetchAndDisplayUsers() {
            const container = document.getElementById('user-list-container');
            // Kosongkan kontainer dari data statis
            container.innerHTML = '';
            
            // Atur delay awal untuk animasi stagger
            let animationDelay = 2.5; 

            try {
                const querySnapshot = await getDocs(collection(db, "users"));
                
                querySnapshot.forEach((doc) => {
                    const user = doc.data();

                    // Buat elemen div utama untuk kartu pengguna
                    const userCard = document.createElement('div');
                    userCard.className = 'user-card stagger-item';
                    userCard.style.animationDelay = `${animationDelay}s`;

                    // Tentukan kelas untuk role (default 'member' jika tidak ada)
                    const role = user.role || 'member'; // Asumsi ada field 'role'
                    const roleClass = role.toLowerCase() === 'admin' ? 'admin' : 'member';

                    // Isi HTML untuk kartu pengguna
                    userCard.innerHTML = `
                        <div class="avatar">ðŸ‘¤</div>
                        <div class="user-info">
                            <h3>${user.displayName || 'Nama Tidak Ada'}</h3>
                            <p>${user.email || 'Email Tidak Ada'}</p>
                        </div>
                        <span class="role ${roleClass}">${role}</span>
                    `;

                    // Tambahkan kartu ke kontainer
                    container.appendChild(userCard);

                    // Tambah delay untuk kartu berikutnya
                    animationDelay += 0.2;
                });

            } catch (error) {
                console.error("Error fetching users: ", error);
                container.innerHTML = `<p style="color: #ff4757; text-align: center;">Gagal memuat data pengguna. Cek konsol (F12).</p>`;
            }
        }

        // Panggil fungsi saat halaman dimuat
        fetchAndDisplayUsers();
    </script>
</body>
</html>
